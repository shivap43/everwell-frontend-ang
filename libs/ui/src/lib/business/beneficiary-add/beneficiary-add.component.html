<empowered-mon-spinner [enableSpinner]="true" backdrop="true" *ngIf="isLoading"></empowered-mon-spinner>

<form [formGroup]="beneficiaryAddForm" (ngSubmit)="save()" class="quasi-modal" #addBeneForm="ngForm">
    <div class="modal-header">
        <h2 mat-dialog-title>{{languageStrings.modalTitle}}</h2>
        <button mat-icon-button (click)="close()" [attr.aria-label]="languageStrings.modalClose">
            <mon-icon class="mon-icon-close" iconSize="25" iconName="close"></mon-icon>
        </button>
    </div>
    <div class="dialog-content">
        <mat-dialog-content>
            <div class="mon-mb-20" *ngIf="showErrorMessageInAlert">
                <mon-alert *ngIf="showErrorMessageInAlert" alertType="danger">
                    <span>{{errorMessage}}</span>
                </mon-alert>
            </div>
            <div class="flex-form-wrapper">
                <h2 class="mon-mt-0">{{languageStrings.aboutBeneficiary}}</h2>
                <div *ngIf="hideFieldElementSetting.beneficiaryType">
                    <mat-label class="mat-label">
                        <span language="primary.portal.members.addBeneficiary.beneficiaryType"></span>
                        <span
                            *ngIf="isOptionalField('beneficiaryType')"
                            class="optional-text"
                            language="primary.portal.common.optional"
                        ></span>
                    </mat-label>
                    <mat-form-field class="w-200">
                        <mat-select
                            (ngModelChange)="onChange($event, addBeneForm)"
                            formControlName="beneficiaryType"
                            name="type"
                            [placeholder]="languageStrings.select"
                            disableOptionCentering="true"
                            [disabled]="readOnlyFieldElementSetting.beneficiaryType"
                        >
                            <mat-option *ngFor="let option of beneficiaryType" [value]="option.name">{{option.value}} </mat-option>
                        </mat-select>
                        <mat-error
                            *ngIf="beneficiaryAddForm.get('beneficiaryType').hasError('required')"
                            language="primary.portal.common.selectionRequired"
                        >
                        </mat-error>
                    </mat-form-field>
                </div>
                <ng-container>
                    <ng-template [ngIf]="currentBeneficiaryType === beneficiaryEnum.INDIVIDUAL">
                        <div class="d-md-flex flex-wrap">
                            <ng-container formGroupName="name">
                                <div class="flex-item" *ngIf="hideFieldElementSetting.firstName">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.firstName"></span>
                                        <span
                                            *ngIf="isOptionalField('firstName')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            formControlName="firstName"
                                            matInput
                                            name="firstName"
                                            empoweredTrimSpace
                                            [attr.aria-label]="languageStrings.firstName"
                                            [readonly]="readOnlyFieldElementSetting.firstName"
                                        />

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('firstName').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        ></mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('firstName').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('firstName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg1"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('firstName').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('firstName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg2"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item" *ngIf="hideFieldElementSetting.middleName">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.beneficiaryEdit.individualMiddleName"></span>
                                        <span
                                            *ngIf="isOptionalField('middleName')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            matInput
                                            formControlName="middleName"
                                            name="middleName"
                                            empoweredTrimSpace
                                            [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.individualMiddleName"] + " " + languageStrings["primary.portal.common.optional"]'
                                            [readonly]="readOnlyFieldElementSetting.middleName"
                                            (input)="isFormValueChange = true"
                                        />
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('middleName').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        ></mat-error>
                                        <mat-error *ngIf="beneficiaryAddForm.controls.name.get('middleName').errors?.pattern as error">
                                            <span
                                                *ngIf="!nameWithHypenApostrophesValidation.test(error.actualValue); else hasHyphensApostrophes"
                                                language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg1"
                                            >
                                            </span>
                                            <ng-template #hasHyphensApostrophes>
                                                <span language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg2"></span>
                                            </ng-template>
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item" *ngIf="hideFieldElementSetting.lastName">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.lastName"></span>
                                        <span
                                            *ngIf="isOptionalField('lastName')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            formControlName="lastName"
                                            matInput
                                            name="lastName"
                                            empoweredTrimSpace
                                            [attr.aria-label]="languageStrings.lastName"
                                            [readonly]="readOnlyFieldElementSetting.lastName"
                                        />

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('lastName').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('lastName').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('lastName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.lastNameMsg1"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('lastName').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('lastName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.lastNameMsg2"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item" *ngIf="hideFieldElementSetting.suffix">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.beneficiaryEdit.individualSuffix"></span>
                                        <span
                                            *ngIf="isOptionalField('suffix')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field class="w-120">
                                        <mat-select
                                            formControlName="suffix"
                                            name="suffix"
                                            [placeholder]="languageStrings['primary.portal.common.placeholderSelect']"
                                            disableOptionCentering="true"
                                            [disabled]="readOnlyFieldElementSetting.suffix"
                                        >
                                            <mat-option *ngFor="let suffix of suffixes" [value]="suffix"> {{suffix}} </mat-option>
                                        </mat-select>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('name').get('suffix').hasError('required')"
                                            language="primary.portal.common.selectionRequired"
                                        ></mat-error>
                                    </mat-form-field>
                                </div>
                            </ng-container>
                        </div>
                        <div class="d-md-flex flex-wrap">
                            <div class="flex-item" formGroupName="name">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.beneficiaryEdit.individualMaidenName"></span>
                                    <span
                                        *ngIf="isOptionalField('maidenName')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    >
                                    </span>
                                </mat-label>
                                <mat-form-field>
                                    <input
                                        matInput
                                        formControlName="maidenName"
                                        name="maidenName"
                                        [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.individualMaidenName"] + " " + languageStrings["primary.portal.common.optional"]'
                                        [readonly]="readOnlyFieldElementSetting.maidenName"
                                        (input)="isFormValueChange = true"
                                    />
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('name').get('maidenName').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('name').get('maidenName').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('maidenName').value)"
                                        language="primary.portal.members.beneficiaryValidationMsg.maidenNameMsg1"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('name').get('maidenName').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('name').get('maidenName').value)"
                                        language="primary.portal.members.beneficiaryValidationMsg.maidenNameMsg2"
                                    ></mat-error>
                                </mat-form-field>
                            </div>
                            <div class="flex-item" *ngIf="hideFieldElementSetting.gender">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.beneficiaryEdit.individualgender"></span>
                                    <span *ngIf="isOptionalField('gender')" class="optional-text" language="primary.portal.common.optional">
                                    </span>
                                </mat-label>
                                <mat-form-field class="w-120">
                                    <mat-select
                                        formControlName="gender"
                                        name="gender"
                                        [placeholder]="languageStrings['primary.portal.common.placeholderSelect']"
                                        disableOptionCentering="true"
                                        [disabled]="readOnlyFieldElementSetting.gender"
                                    >
                                        <mat-option *ngFor="let gender of (genders$ | async)" [value]="gender.value">
                                            {{gender.for}}
                                        </mat-option>
                                    </mat-select>

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('gender').hasError('required')"
                                        language="primary.portal.common.selectionRequired"
                                    ></mat-error>
                                </mat-form-field>
                            </div>
                            <div class="flex-item" *ngIf="hideFieldElementSetting.birthDate">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.beneficiaryEdit.individualBirthDate"></span>
                                    <span
                                        *ngIf="isOptionalField('birthDate')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    >
                                    </span>
                                </mat-label>
                                <mat-form-field class="w-150 mon-date-field">
                                    <input
                                        matInput
                                        [matDatepicker]="picker"
                                        [max]="maxDate"
                                        formControlName="birthDate"
                                        name="birthDate"
                                        [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.individualBirthDate"] + " " + languageStrings["primary.portal.common.optional"]'
                                        [readonly]="readOnlyFieldElementSetting.birthDate"
                                        #datePickerInput
                                        (keyup)="transform($event)"
                                        (input)="isFormValueChange = true"
                                    />
                                    <mat-error *ngIf="isBirthdateInvalid"
                                        >{{validateDate('birthDate', 'beneficiaryEditForm', datePickerInput.value)}}</mat-error
                                    >
                                    <mat-datepicker-toggle matSuffix [for]="picker" (click)="picker.open()">
                                        <mon-icon iconName="calendar-date" [iconSize]="20" matDatepickerToggleIcon></mon-icon>
                                    </mat-datepicker-toggle>

                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-hint language="primary.portal.common.dateHint"></mat-hint>
                                </mat-form-field>
                            </div>
                            <div class="flex-item">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.member.ssn_itin"></span>
                                    <span *ngIf="ssnOptionalField" class="optional-text" language="primary.portal.common.optional"> </span>
                                </mat-label>
                                <mat-form-field>
                                    <div class="d-flex">
                                        <input
                                            matInput
                                            formControlName="ssn"
                                            name="ssn"
                                            [attr.aria-label]="individualSSN"
                                            [readonly]="readOnlyFieldElementSetting.ssn || isMaskedTrue"
                                            (click)="ssnMaskingToggler(true)"
                                            (focusin)="ssnMaskingToggler(true)"
                                            (focusout)="ssnMaskingToggler(false)"
                                            empoweredSsnFormat
                                            [maxlength]="ssnMaxLength"
                                            (change)="maskValue()"
                                            (keydown)="onSSNValueChange()"
                                            (input)="isFormValueChange = true"
                                        />
                                        <span *ngIf="isShowHideButtonVisible && beneficiaryAddForm.controls.ssn.valid && isSSNValue">
                                            <a
                                                href="javascript:void(0)"
                                                *ngIf="isMaskedTrue"
                                                (click)="ssnMaskingToggler(true)"
                                                class="nodec-link"
                                                >{{languageStringArray['primary.portal.common.show']}}</a
                                            >
                                            <a
                                                href="javascript:void(0)"
                                                *ngIf="!isMaskedTrue"
                                                (click)="ssnMaskingToggler(false)"
                                                class="nodec-link"
                                                >{{languageStringArray['primary.portal.common.hide']}}</a
                                            >
                                        </span>
                                    </div>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('ssn').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('ssn').hasError('pattern') && beneficiaryAddForm.get('ssn').value.length === ssnMaxLength"
                                        language="primary.portal.members.beneficiaryValidationMsg.SSNMsg2"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('ssn').value && beneficiaryAddForm.get('ssn').value.length !== ssnMaxLength"
                                        language="primary.portal.members.beneficiaryValidationMsg.SSNMsg1"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('ssn').errors?.duplicate"
                                        language="secondary.portal.members.beneficiary.ssn.duplicate"
                                    ></mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="d-md-flex flex-wrap">
                            <div class="flex-item" *ngIf="hideFieldElementSetting.relationshipToMember">
                                <mat-label class="mat-label">
                                    <span>{{ relationshipMemberLabel }}</span>
                                    <span
                                        *ngIf="isOptionalField('relationshipToMember')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    ></span>
                                </mat-label>

                                <mat-form-field>
                                    <input
                                        formControlName="relationshipToMember"
                                        autocomplete="off"
                                        matInput
                                        name="relationshipToMember"
                                        empoweredTrimSpace
                                        [attr.aria-label]="languageStrings.relationshipToMember"
                                        [readonly]="readOnlyFieldElementSetting.relationshipToMember"
                                    />

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('relationshipToMember').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    >
                                    </mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('relationshipToMember').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('relationshipToMember').value)"
                                        language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg1"
                                    >
                                    </mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('relationshipToMember').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('relationshipToMember').value)"
                                        language="primary.portal.members.beneficiaryValidationMsg.firstNameMsg2"
                                    >
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="d-md-flex">
                            <div class="flex-item">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.beneficiaryEdit.individualDetail"></span>
                                    <span
                                        *ngIf="isOptionalField('details')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    >
                                    </span>
                                </mat-label>
                                <mat-form-field class="textarea w-400">
                                    <textarea
                                        matInput
                                        formControlName="details"
                                        name="details"
                                        rows="5"
                                        [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.individualDetail"] + " " + languageStrings["primary.portal.common.optional"]'
                                        [readonly]="readOnlyFieldElementSetting.details"
                                        (input)="isFormValueChange = true"
                                    ></textarea>
                                    <mat-error>
                                        <span
                                            *ngIf="beneficiaryAddForm.get('details').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        ></span>
                                    </mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.controls.details.hasError('pattern')"
                                        language="primary.portal.members.beneficiaryValidationMsg.streetAddress2"
                                    >
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template [ngIf]="currentBeneficiaryType === beneficiaryEnum.CHARITY">
                        <div class="d-md-flex">
                            <div class="flex-item" *ngIf="hideFieldElementSetting.organizationName">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.addBeneficiary.organizationName"></span>
                                    <span
                                        *ngIf="isOptionalField('organizationName')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    ></span>
                                </mat-label>
                                <mat-form-field>
                                    <input
                                        formControlName="organizationName"
                                        matInput
                                        name="name"
                                        [attr.aria-label]="languageStrings.organizationName"
                                        [readonly]="readOnlyFieldElementSetting.organizationName"
                                    />

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('organizationName').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    >
                                    </mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('organizationName').hasError('pattern') "
                                        language="primary.portal.members.beneficiaryValidationMsg.orgName"
                                    >
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template [ngIf]="currentBeneficiaryType === beneficiaryEnum.TRUST">
                        <div class="d-md-flex">
                            <div class="flex-item" *ngIf="hideFieldElementSetting.trustName">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.addBeneficiary.trustName"></span>
                                    <span
                                        *ngIf="isOptionalField('trustName')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    ></span>
                                </mat-label>
                                <mat-form-field>
                                    <input
                                        formControlName="trustName"
                                        matInput
                                        name="trustName"
                                        [attr.aria-label]="languageStrings.trustName"
                                        [readonly]="readOnlyFieldElementSetting.trustName"
                                    />

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('trustName').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    >
                                    </mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('trustName').hasError('pattern')"
                                        language="primary.portal.members.beneficiaryValidationMsg.trustName"
                                    >
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="flex-item" *ngIf="hideFieldElementSetting.trustAgreementDate">
                                <mat-label class="mat-label">
                                    <span language="primary.portal.members.addBeneficiary.trustAgreementDate"></span>
                                    <span
                                        *ngIf="isOptionalField('trustAgreementDate')"
                                        class="optional-text"
                                        language="primary.portal.common.optional"
                                    ></span>
                                </mat-label>
                                <mat-form-field class="mon-date-field">
                                    <input
                                        formControlName="trustAgreementDate"
                                        [matDatepicker]="picker"
                                        matInput
                                        [max]="maxDate"
                                        name="trustAgreementDate"
                                        empoweredDateTransform
                                        [attr.aria-label]="languageStrings.trustAgreementDate"
                                        [readonly]="readOnlyFieldElementSetting.trustAgreementDate"
                                    />

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('trustAgreementDate').hasError('matDatepickerParse') ||
                                        beneficiaryAddForm.get('trustAgreementDate').hasError('matDatepickerMax');else requiredError"
                                        language="secondary.portal.benefitsOffering.coveragedates.invalidDate"
                                    >
                                    </mat-error>
                                    <ng-template #requiredError
                                        ><mat-error
                                            *ngIf="beneficiaryAddForm.get('trustAgreementDate').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error
                                    ></ng-template>
                                    <mat-datepicker-toggle matSuffix [for]="picker" (click)="picker.open()">
                                        <mon-icon iconName="calendar-date" [iconSize]="20" matDatepickerToggleIcon> </mon-icon>
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-hint language="primary.portal.common.dateHint"></mat-hint>
                                </mat-form-field>
                            </div>
                        </div>
                        <ng-container formGroupName="contact">
                            <ng-container formGroupName="address" *ngIf="currentBeneficiaryType">
                                <div class="d-md-flex">
                                    <div class="flex-item" *ngIf="hideFieldElementSetting.state">
                                        <mat-label class="mat-label" id="beneficiaryAddressState">
                                            <span language="primary.portal.members.addBeneficiary.state"></span>
                                            <span
                                                *ngIf="stateOptionalField"
                                                class="optional-text"
                                                language="primary.portal.common.optional"
                                            ></span>
                                        </mat-label>
                                        <mat-form-field class="w-100">
                                            <mat-select
                                                formControlName="state"
                                                name="state"
                                                [placeholder]="languageStrings.select"
                                                disableOptionCentering="true"
                                                [disabled]="readOnlyFieldElementSetting.state"
                                                aria-labelledby="beneficiaryAddressState"
                                            >
                                                <mat-option *ngFor="let state of states" [value]="state.abbreviation">
                                                    {{ state.abbreviation }}
                                                </mat-option>
                                            </mat-select>

                                            <mat-error
                                                *ngIf="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.state?.errors?.required"
                                                language="primary.portal.common.selectionRequired"
                                            >
                                            </mat-error>
                                            <mat-hint
                                                *ngIf="currentBeneficiaryType === beneficiaryEnum.CHARITY"
                                                language="primary.portal.members.addBeneficiary.stateHint"
                                            ></mat-hint>
                                        </mat-form-field>
                                    </div>
                                    <div class="flex-item" *ngIf="hideFieldElementSetting.zip">
                                        <empowered-zip-code-input
                                            [formControl]="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip"
                                            [stateControlValue]="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.state?.value"
                                        >
                                            <mat-error
                                                *ngIf="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip?.errors?.required"
                                                language="secondary.portal.members.requiredField"
                                            >
                                            </mat-error>
                                            <mat-error
                                                *ngIf="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip?.errors?.pattern"
                                                language="primary.portal.members.beneficiaryValidationMsg.zipCode"
                                            >
                                            </mat-error>
                                        </empowered-zip-code-input>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                        <ng-container formGroupName="trustee">
                            <div class="d-md-flex">
                                <div class="flex-item" *ngIf="hideFieldElementSetting.trusteeFirstName">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.trusteeFirstName"></span>
                                        <span
                                            *ngIf="isOptionalField('trusteeFirstName')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            formControlName="firstName"
                                            matInput
                                            name="firstName"
                                            [attr.aria-label]="languageStrings.trusteeFirstName"
                                            [readonly]="readOnlyFieldElementSetting.trusteeFirstName"
                                        />

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('firstName').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('firstName').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('trustee').get('firstName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.trusteeFirstNameMsg1"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('firstName').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('trustee').get('firstName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.trusteeFirstNameMsg2"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item" *ngIf="hideFieldElementSetting.trusteeLastName">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.lastName"></span>
                                        <span
                                            *ngIf="isOptionalField('trusteeLastName')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            formControlName="lastName"
                                            matInput
                                            name="lastName"
                                            [attr.aria-label]="languageStrings.lastName"
                                            [readonly]="readOnlyFieldElementSetting.trusteeLastName"
                                        />

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('lastName').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('lastName').hasError('pattern') && ! nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('trustee').get('lastName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.trusteeLastNameMsg1"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('lastName').hasError('pattern') &&  nameWithHypenApostrophesValidation.test(beneficiaryAddForm.get('trustee').get('lastName').value)"
                                            language="primary.portal.members.beneficiaryValidationMsg.trusteeLastNameMsg2"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item w-200" *ngIf="hideFieldElementSetting.trusteeSuffix">
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.suffix"></span>
                                        <span
                                            *ngIf="isOptionalField('trusteeSuffix')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field>
                                        <mat-select
                                            formControlName="suffix"
                                            name="suffix"
                                            [placeholder]="languageStrings.select"
                                            disableOptionCentering="true"
                                            [disabled]="readOnlyFieldElementSetting.trusteeSuffix"
                                        >
                                            <mat-option *ngFor="let suffix of suffixes" [value]="suffix"> {{suffix}} </mat-option>
                                        </mat-select>

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('trustee').get('suffix').hasError('required')"
                                            language="primary.portal.common.selectionRequired"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                        </ng-container>
                    </ng-template>
                </ng-container>
                <ng-container>
                    <ng-template [ngIf]="currentBeneficiaryType === beneficiaryEnum.INDIVIDUAL">
                        <mat-divider></mat-divider>
                        <h2>{{languageStringArray["primary.portal.members.beneficiaryEdit.individualContactInfoTitle"]}}</h2>
                        <div class="mon-mb-30">
                            <mat-checkbox formControlName="homeAddressSameAsEmployee">
                                <span>{{samePrimaryAddressLabel}}</span>
                            </mat-checkbox>
                            <div>
                                <mat-hint *ngIf="incompleteAddress">
                                    {{languageStringArray["primary.portal.members.beneficiaryAdd.completeAddress"] | replaceTag : {
                                    "##empname##" : empFirstName} }}</mat-hint
                                >
                            </div>
                            <mat-error *ngIf="memberContactError"> {{memberContactError}} </mat-error>
                        </div>
                    </ng-template>
                </ng-container>
                <ng-container formGroupName="contact">
                    <ng-template [ngIf]="currentBeneficiaryType">
                        <ng-container formGroupName="address">
                            <div class="d-md-flex">
                                <div
                                    class="flex-item"
                                    *ngIf="hideFieldElementSetting.address1 && currentBeneficiaryType === beneficiaryEnum.INDIVIDUAL"
                                >
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.beneficiaryEdit.streetAddress1"></span>
                                        <span
                                            *ngIf="isOptionalField('address1')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            matInput
                                            formControlName="address1"
                                            name="address1"
                                            [attr.aria-label]="languageStrings['primary.portal.members.beneficiaryEdit.streetAddress1']"
                                            [readonly]="readOnlyFieldElementSetting.address1"
                                            (input)="isFormValueChange = true"
                                        />
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address1').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address1').hasError('pattern')"
                                            language="primary.portal.members.beneficiaryValidationMsg.streetAddress1"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address1').hasError('maxlength')"
                                            language="primary.portal.members.beneficiaryValidationMsg.streetAddress1.maxlength"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div
                                    class="flex-item"
                                    *ngIf="hideFieldElementSetting.address2 && currentBeneficiaryType === beneficiaryEnum.INDIVIDUAL"
                                >
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.beneficiaryEdit.streetAddress2"></span>
                                        <span
                                            *ngIf="isOptionalField('address2')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            matInput
                                            formControlName="address2"
                                            name="address2"
                                            [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.streetAddress2"] + " " + languageStrings["primary.portal.common.optional"]'
                                            [readonly]="readOnlyFieldElementSetting.address2"
                                            (input)="isFormValueChange = true"
                                        />
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address2').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address2').hasError('pattern')"
                                            language="primary.portal.members.beneficiaryValidationMsg.streetAddress2"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('address2').hasError('maxlength')"
                                            language="primary.portal.members.beneficiaryValidationMsg.streetAddress2.maxlength"
                                        >
                                        </mat-error>
                                        <mat-hint
                                            *ngIf="currentBeneficiaryType == beneficiaryEnum.INDIVIDUAL"
                                            language="primary.portal.members.streetAddressHint1"
                                        >
                                        </mat-hint>
                                        <mat-hint
                                            *ngIf="currentBeneficiaryType == beneficiaryEnum.CHARITY || currentBeneficiaryType == beneficiaryEnum.TRUST"
                                            language="primary.portal.members.streetAddressHint2"
                                        >
                                        </mat-hint>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="d-md-flex">
                                <div
                                    class="flex-item"
                                    *ngIf="hideFieldElementSetting.city && currentBeneficiaryType === beneficiaryEnum.INDIVIDUAL"
                                >
                                    <mat-label class="mat-label"
                                        ><span language="primary.portal.members.beneficiaryEdit.city"></span>
                                        <span
                                            *ngIf="isOptionalField('city')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            matInput
                                            formControlName="city"
                                            name="city"
                                            [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.city"] + " " + languageStrings["primary.portal.common.optional"]'
                                            [readonly]="readOnlyFieldElementSetting.city"
                                            (input)="isFormValueChange = true"
                                        />
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('city').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        ></mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('city').hasError('pattern')"
                                            language="primary.portal.members.beneficiaryValidationMsg.city"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('city').hasError('maxlength')"
                                            language="primary.portal.members.beneficiaryValidationMsg.city.maxlength"
                                        >
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div
                                    class="flex-item"
                                    *ngIf="hideFieldElementSetting.state && currentBeneficiaryType !== beneficiaryEnum.TRUST"
                                >
                                    <mat-label class="mat-label">
                                        <span language="primary.portal.members.addBeneficiary.state"></span>
                                        <span
                                            *ngIf="isOptionalField('state')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        ></span>
                                    </mat-label>
                                    <mat-form-field class="w-100">
                                        <mat-select
                                            formControlName="state"
                                            name="state"
                                            [placeholder]="languageStrings.select"
                                            disableOptionCentering="true"
                                            [disabled]="readOnlyFieldElementSetting.state"
                                        >
                                            <mat-option *ngFor="let state of states" [value]="state.abbreviation">
                                                {{ state.abbreviation }}
                                            </mat-option>
                                        </mat-select>

                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('address').get('state').hasError('required')"
                                            language="primary.portal.common.selectionRequired"
                                        >
                                        </mat-error>
                                        <mat-hint
                                            *ngIf="currentBeneficiaryType === beneficiaryEnum.CHARITY"
                                            language="primary.portal.members.addBeneficiary.stateHint"
                                        ></mat-hint>
                                    </mat-form-field>
                                </div>
                                <div
                                    class="flex-item"
                                    *ngIf="hideFieldElementSetting.zip && currentBeneficiaryType !== beneficiaryEnum.TRUST"
                                >
                                    <empowered-zip-code-input
                                        [formControl]="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip"
                                        [stateControlValue]="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.state?.value"
                                    >
                                        <mat-error
                                            *ngIf="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip?.errors?.required"
                                            language="secondary.portal.members.requiredField"
                                        >
                                        </mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm?.controls?.contact?.controls?.address?.controls?.zip?.errors?.pattern"
                                            language="primary.portal.members.beneficiaryValidationMsg.zipCode"
                                        >
                                        </mat-error>
                                    </empowered-zip-code-input>
                                </div>
                            </div>
                        </ng-container>
                        <div class="d-md-flex" *ngIf="currentBeneficiaryType == beneficiaryEnum.INDIVIDUAL">
                            <div formGroupName="emailAddresses" class="flex-item">
                                <mat-label class="mat-label"
                                    ><span
                                        *ngIf="currentBeneficiaryType == beneficiaryEnum.CHARITY || currentBeneficiaryType == beneficiaryEnum.TRUST"
                                        language="primary.portal.members.beneficiaryEdit.contactEmail"
                                    ></span>
                                    <span
                                        *ngIf="currentBeneficiaryType == beneficiaryEnum.INDIVIDUAL"
                                        language="primary.portal.members.beneficiaryEdit.email"
                                    ></span>
                                    <span *ngIf="isOptionalField('email')" class="optional-text" language="primary.portal.common.optional">
                                    </span>
                                </mat-label>
                                <mat-form-field>
                                    <input
                                        matInput
                                        formControlName="email"
                                        name="email"
                                        [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.contactEmail"] + " " + languageStrings["primary.portal.common.optional"]'
                                        [readonly]="readOnlyFieldElementSetting.email"
                                        (input)="isFormValueChange = true"
                                    />

                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('contact').get('emailAddresses').get('email').hasError('required')"
                                        language="secondary.portal.members.requiredField"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('contact').get('emailAddresses').get('email').hasError('pattern')"
                                        language="primary.portal.members.beneficiaryValidationMsg.email"
                                    ></mat-error>
                                    <mat-error
                                        *ngIf="beneficiaryAddForm.get('contact').get('emailAddresses').get('email').hasError('maxlength')"
                                        language="primary.portal.members.beneficiaryValidationMsg.email.maxlength"
                                    >
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <ng-container formGroupName="phoneNumbers" *ngIf="hideFieldElementSetting.phoneNumber">
                                <div class="flex-item">
                                    <mat-label class="mat-label"
                                        ><span
                                            *ngIf="currentBeneficiaryType == beneficiaryEnum.CHARITY || currentBeneficiaryType == beneficiaryEnum.TRUST"
                                            language="primary.portal.members.beneficiaryEdit.contactPhone"
                                        ></span>
                                        <span
                                            *ngIf="currentBeneficiaryType == beneficiaryEnum.INDIVIDUAL"
                                            language="primary.portal.members.beneficiaryEdit.phone"
                                        ></span>
                                        <span
                                            *ngIf="isOptionalField('phoneNumber')"
                                            class="optional-text"
                                            language="primary.portal.common.optional"
                                        >
                                        </span>
                                    </mat-label>
                                    <mat-form-field>
                                        <input
                                            matInput
                                            formControlName="phoneNumber"
                                            name="phoneNumber"
                                            [maxlength]="phoneMaxLength"
                                            [attr.aria-label]='languageStrings["primary.portal.members.beneficiaryEdit.contactPhone"] + " " + languageStrings["primary.portal.common.optional"]'
                                            [readonly]="readOnlyFieldElementSetting.phoneNumber"
                                            empoweredNumberValidation
                                            [allowDashes]="true"
                                            empoweredPhoneNumberFormat
                                            (input)="isFormValueChange = true"
                                        />
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('phoneNumbers').get('phoneNumber').hasError('required')"
                                            language="secondary.portal.members.requiredField"
                                        ></mat-error>
                                        <mat-error
                                            *ngIf="beneficiaryAddForm.get('contact').get('phoneNumbers').get('phoneNumber').hasError('pattern')"
                                            language="primary.portal.members.beneficiaryValidationMsg.phoneNumber"
                                        ></mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item">
                                    <mat-label
                                        class="mat-label"
                                        language="primary.portal.census.manualEntry.phoneType"
                                        id="memberPhoneType"
                                    ></mat-label>
                                    <mat-form-field>
                                        <mat-select formControlName="type" aria-labelledby="memberPhoneType">
                                            <mat-option *ngFor="let phoneTypeItem of phoneNumberTypes" [value]="phoneTypeItem"
                                                >{{phoneTypeItem}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="flex-item mon-mt-30">
                                    <mat-checkbox formControlName="isMobile">
                                        <span language="primary.portal.census.manualEntry.isMobilenumber"></span>
                                    </mat-checkbox>
                                </div>
                            </ng-container>
                        </div>
                    </ng-template>
                </ng-container>
            </div>
        </mat-dialog-content>
    </div>
    <mat-dialog-actions class="dialog-footer">
        <a
            href="javascript:void(0)"
            class="mon-btn-link"
            language="primary.portal.common.cancel"
            mat-dialog-close
            (click)="close()"
            [attr.aria-label]="languageStrings.ariaCancel"
        ></a>
        <button
            class="mon-btn-primary mon-px-30"
            language="primary.portal.common.save"
            mat-flat-button
            type="submit"
            [attr.aria-label]="languageStrings.ariaSave"
        ></button>
    </mat-dialog-actions>
</form>
